{% extends "base.html" %}
{% block title %}Cleaning{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block body %}
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="tablebox">
                <div class="ui negative message">
                    <i class="close icon"></i>
                    <div class="header">
                        Ein oder Mehrere Fehler sind aufgetreten
                    </div>
                    <ul class="list">
                        {% for message in messages %}
                            <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
    {% endwith %}
    <div class="ui container">
        <a href="{{ url_for('add_cleaning') }}">
            <div class="ui primary labeled icon button">
                <i class="plus icon"></i> Job hinzufügen
            </div>
        </a>

        <table class="ui celled fixed table">
            <thead>
            <tr>
                <th>Status</th>
                <th>Job Name</th>
                <th>Pfad</th>
                <th>Letzte Ausführung</th>
                <th>Aktionen</th>
            </tr>
            </thead>

            <tbody>
            {% for element in elements %}
                <tr>
                    <td>{{ element.state }}</td>
                    <td>{{ element.name }}</td>
                    <td>{{ element.path }}</td>
                    <td>{{ element.time }}</td>
                    <td>
                        <div class="buttonspace">
                            <a href="{{ url_for('cleaning', remove=(element.id)) }}">
                                <div class="ui button">
                                    <i class="plus icon"></i> Job entfernen
                                </div>
                            </a></div>
                        <a href="{{ url_for('cleaning', changestate=(element.id)) }}">
                            <div class="ui button">
                                <i class="plus icon"></i> Status ändern
                            </div>
                        </a>
                    </td>
                </tr>

            {% endfor %}
            </tbody>
        </table>
    </div>
    <script>
        $('.message .close')
            .on('click', function () {
                $(this)
                    .closest('.message')
                    .transition('fade')
                ;
            })
        ;
    </script>
{% endblock %}
